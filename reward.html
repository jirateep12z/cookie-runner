<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üéÅ ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• - Cookie Runner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/easywheel.css" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              'sans': ['Noto Sans Thai', 'sans-serif']
            },
            colors: {
              'game-primary': '#8B4513',
              'game-secondary': '#D2691E',
              'game-gold': '#FFD700'
            }
          }
        }
      };
    </script>
    <style>
      body {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        min-height: 100vh;
      }
      
      .glow-text {
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.8), 0 0 20px rgba(255, 215, 0, 0.6);
      }
      
      .spin-btn {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        transition: all 0.3s ease;
      }
      
      .spin-btn:hover:not(:disabled) {
        transform: scale(1.05);
        box-shadow: 0 0 30px rgba(245, 158, 11, 0.6);
      }
      
      .spin-btn:disabled {
        background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        cursor: not-allowed;
      }
      
      .reward-popup {
        animation: popup-in 0.5s ease-out;
      }
      
      @keyframes popup-in {
        0% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(0.5);
        }
        100% {
          opacity: 1;
          transform: translate(-50%, -50%) scale(1);
        }
      }
      
      .confetti {
        position: fixed;
        width: 10px;
        height: 10px;
        pointer-events: none;
        z-index: 100;
      }
    </style>
  </head>
  <body class="text-white overflow-x-hidden">
    <!-- Header -->
    <header class="bg-black/30 backdrop-blur-sm py-4 px-6">
      <div class="max-w-4xl mx-auto flex justify-between items-center">
        <a href="index.html" class="flex items-center gap-2 text-white hover:text-amber-400 transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          <span class="font-bold">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°</span>
        </a>
        
        <!-- Cookie Balance -->
        <div class="flex items-center gap-3 bg-gradient-to-r from-amber-500/70 to-orange-500/70 px-5 py-2 rounded-full">
          <span class="text-2xl">üç™</span>
          <span id="cookie-balance" class="text-2xl font-bold">0</span>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8">
      <h1 class="text-4xl md:text-5xl font-bold text-center mb-2 glow-text text-game-gold">
        üéÅ ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
      </h1>
      <p class="text-center text-white/70 mb-8">‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©!</p>

      <!-- Wheel Container -->
      <div class="flex flex-col items-center">
        <div id="reward-wheel" class="mb-8"></div>
        
        <!-- Spin Cost -->
        <div class="text-center mb-6">
          <p class="text-lg text-white/80 mb-2">‡∏Ñ‡πà‡∏≤‡∏´‡∏°‡∏∏‡∏ô</p>
          <div class="flex items-center justify-center gap-2 bg-black/40 px-6 py-3 rounded-full">
            <span class="text-3xl">üç™</span>
            <span class="text-3xl font-bold text-amber-400">1,000</span>
          </div>
        </div>

        <!-- Spin Button -->
        <button id="spin-btn" class="spin-btn px-12 py-4 rounded-full text-2xl font-bold text-white shadow-lg">
          üé∞ ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡∏¢!
        </button>
        
        <p id="spin-message" class="mt-4 text-lg text-center hidden"></p>
      </div>

      <!-- Rewards Info -->
      <div class="mt-12 grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
          <div class="text-3xl mb-2">‚ù§Ô∏è</div>
          <p class="font-bold">‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏û‡∏¥‡πÄ‡∏®‡∏©</p>
          <p class="text-sm text-white/60">+1 ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
          <div class="text-3xl mb-2">üç™‚ú®</div>
          <p class="font-bold">Cookie Boost</p>
          <p class="text-sm text-white/60">x2 ‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ 30 ‡∏ß‡∏¥</p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
          <div class="text-3xl mb-2">üõ°Ô∏è</div>
          <p class="font-bold">‡πÇ‡∏•‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</p>
          <p class="text-sm text-white/60">‡∏Å‡∏±‡∏ô‡∏î‡∏≤‡πÄ‡∏°‡∏à 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center">
          <div class="text-3xl mb-2">üç™</div>
          <p class="font-bold">‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ‡πÇ‡∏ö‡∏ô‡∏±‡∏™</p>
          <p class="text-sm text-white/60">+500 ‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ</p>
        </div>
      </div>

      <!-- Inventory -->
      <div class="mt-12">
        <h2 class="text-2xl font-bold mb-4 text-center">üéí ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</h2>
        <div id="inventory" class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
          <p id="empty-inventory" class="text-center text-white/50">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏•‡∏¢!</p>
          <div id="inventory-items" class="grid grid-cols-2 md:grid-cols-4 gap-4 hidden"></div>
        </div>
      </div>

      <!-- Quick Links -->
      <div class="mt-8 flex flex-wrap justify-center gap-4">
        <a
          href="shop.html"
          class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-full font-bold transition-all hover:scale-105 flex items-center gap-2"
        >
          <span>üõí</span>
          <span>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏£‡∏á)</span>
        </a>
        <a
          href="index.html"
          class="px-6 py-3 bg-amber-600 hover:bg-amber-700 rounded-full font-bold transition-all hover:scale-105 flex items-center gap-2"
        >
          <span>üéÆ</span>
          <span>‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</span>
        </a>
      </div>
    </main>

    <!-- Reward Popup -->
    <div id="reward-popup" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden">
      <div class="reward-popup absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-br from-purple-900 to-indigo-900 rounded-3xl p-8 text-center max-w-sm w-full mx-4">
        <div id="popup-icon" class="text-7xl mb-4"></div>
        <h3 id="popup-title" class="text-3xl font-bold text-game-gold mb-2"></h3>
        <p id="popup-desc" class="text-white/80 mb-6"></p>
        <button id="popup-close" class="bg-amber-500 hover:bg-amber-600 px-8 py-3 rounded-full font-bold transition-colors">
          ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
        </button>
      </div>
    </div>

    <script src="js/easywheel.js"></script>
    <script>
      const SPIN_COST = 1000;
      
      const REWARDS = [
        { name: '‡∏´‡∏±‡∏ß‡πÉ‡∏à +1', color: '#ef4444', type: 'heart', value: 1 },
        { name: '+500', color: '#f59e0b', type: 'cookies', value: 500 },
        { name: 'x2 Cookie', color: '#fbbf24', type: 'cookie_boost', value: 1 },
        { name: '‡πÇ‡∏•‡πà', color: '#3b82f6', type: 'shield', value: 1 },
        { name: '+200', color: '#d97706', type: 'cookies', value: 200 },
        { name: '‡∏´‡∏±‡∏ß‡πÉ‡∏à +2', color: '#dc2626', type: 'heart', value: 2 },
        { name: 'Mystery', color: '#8b5cf6', type: 'mystery', value: 1 },
        { name: '+1000', color: '#f97316', type: 'cookies', value: 1000 }
      ];

      class RewardManager {
        constructor() {
          this.cookies = this.LoadCookies();
          this.inventory = this.LoadInventory();
          this.wheel = null;
          this.is_spinning = false;
          
          this.InitWheel();
          this.InitEventListeners();
          this.UpdateUI();
        }

        LoadCookies() {
          const saved = localStorage.getItem('game_total_cookies');
          return saved ? parseInt(saved, 10) : 0;
        }

        SaveCookies() {
          localStorage.setItem('game_total_cookies', this.cookies.toString());
        }

        LoadInventory() {
          const saved = localStorage.getItem('game_inventory');
          return saved ? JSON.parse(saved) : {};
        }

        SaveInventory() {
          localStorage.setItem('game_inventory', JSON.stringify(this.inventory));
        }

        InitWheel() {
          this.wheel = new EasyWheel('#reward-wheel', {
            items: REWARDS,
            width: 384,
            font_size: 14,
            text_line: 'v',
            text_offset: 15,
            center_width: 30,
            center_background: '#1e1b4b',
            center_line_color: '#fbbf24',
            center_line_width: 3,
            slice_line_width: 2,
            slice_line_color: '#1e1b4b',
            outer_line_color: '#fbbf24',
            outer_line_width: 4,
            marker_color: '#fbbf24',
            duration: 5000,
            rotates: 6,
            random: true,
            easing: 'EasyWheel',
            on_start: () => {
              this.is_spinning = true;
              this.UpdateSpinButton();
            },
            on_complete: (result) => {
              this.is_spinning = false;
              this.HandleReward(result);
              this.UpdateSpinButton();
            }
          });
        }

        InitEventListeners() {
          document.getElementById('spin-btn').addEventListener('click', () => this.Spin());
          document.getElementById('popup-close').addEventListener('click', () => this.ClosePopup());
        }

        Spin() {
          if (this.is_spinning) return;
          
          if (this.cookies < SPIN_COST) {
            this.ShowMessage('‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ 1,000 ‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ', 'error');
            return;
          }

          this.cookies -= SPIN_COST;
          this.SaveCookies();
          this.UpdateUI();
          
          this.wheel.Start();
        }

        HandleReward(result) {
          const reward_type = result.type;
          const reward_value = result.value;

          if (reward_type === 'cookies') {
            this.cookies += reward_value;
            this.SaveCookies();
          } else if (reward_type === 'mystery') {
            const mystery_rewards = ['heart', 'shield', 'cookie_boost'];
            const random_type = mystery_rewards[Math.floor(Math.random() * mystery_rewards.length)];
            result.type = random_type;
            result.name = this.GetMysteryName(random_type);
          }
          
          if (reward_type !== 'cookies') {
            if (!this.inventory[result.type]) {
              this.inventory[result.type] = 0;
            }
            this.inventory[result.type] += reward_value;
            this.SaveInventory();
          }

          this.UpdateUI();
          this.ShowRewardPopup(result);
          this.CreateConfetti();
        }

        GetMysteryName(type) {
          const names = {
            heart: '‚ù§Ô∏è ‡∏´‡∏±‡∏ß‡πÉ‡∏à +1',
            shield: 'üõ°Ô∏è ‡πÇ‡∏•‡πà',
            cookie_boost: 'üç™‚ú® x2 Cookie'
          };
          return names[type] || 'üéÅ Mystery';
        }

        ShowRewardPopup(result) {
          const popup = document.getElementById('reward-popup');
          const icon_map = {
            heart: '‚ù§Ô∏è',
            cookies: 'üç™',
            cookie_boost: 'üç™‚ú®',
            shield: 'üõ°Ô∏è',
            mystery: 'üéÅ'
          };
          
          document.getElementById('popup-icon').textContent = icon_map[result.type] || 'üéÅ';
          document.getElementById('popup-title').textContent = '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!';
          document.getElementById('popup-desc').textContent = `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${result.name}`;
          
          popup.classList.remove('hidden');
        }

        ClosePopup() {
          document.getElementById('reward-popup').classList.add('hidden');
        }

        ShowMessage(text, type = 'info') {
          const message_el = document.getElementById('spin-message');
          message_el.textContent = text;
          message_el.className = `mt-4 text-lg text-center ${type === 'error' ? 'text-red-400' : 'text-green-400'}`;
          message_el.classList.remove('hidden');
          
          setTimeout(() => {
            message_el.classList.add('hidden');
          }, 3000);
        }

        UpdateUI() {
          document.getElementById('cookie-balance').textContent = this.cookies.toLocaleString();
          this.UpdateSpinButton();
          this.UpdateInventory();
        }

        UpdateSpinButton() {
          const btn = document.getElementById('spin-btn');
          const can_spin = this.cookies >= SPIN_COST && !this.is_spinning;
          
          btn.disabled = !can_spin;
          
          if (this.is_spinning) {
            btn.textContent = 'üé∞ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏°‡∏∏‡∏ô...';
          } else if (this.cookies < SPIN_COST) {
            btn.textContent = 'üç™ ‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏û‡∏≠';
          } else {
            btn.textContent = 'üé∞ ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏•‡∏¢!';
          }
        }

        UpdateInventory() {
          const empty_el = document.getElementById('empty-inventory');
          const items_el = document.getElementById('inventory-items');
          
          const has_items = Object.keys(this.inventory).length > 0;
          
          if (has_items) {
            empty_el.classList.add('hidden');
            items_el.classList.remove('hidden');
            
            const icon_map = {
              heart: '‚ù§Ô∏è',
              shield: 'üõ°Ô∏è',
              cookie_boost: 'üç™‚ú®'
            };
            
            const name_map = {
              heart: '‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏û‡∏¥‡πÄ‡∏®‡∏©',
              shield: '‡πÇ‡∏•‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô',
              cookie_boost: 'Cookie Boost'
            };
            
            items_el.innerHTML = Object.entries(this.inventory).map(([type, count]) => `
              <div class="bg-white/10 rounded-lg p-3 text-center">
                <div class="text-2xl mb-1">${icon_map[type] || 'üéÅ'}</div>
                <p class="text-sm font-bold">${name_map[type] || type}</p>
                <p class="text-amber-400 font-bold">x${count}</p>
              </div>
            `).join('');
          } else {
            empty_el.classList.remove('hidden');
            items_el.classList.add('hidden');
          }
        }

        CreateConfetti() {
          const colors = ['#f59e0b', '#ef4444', '#3b82f6', '#10b981', '#8b5cf6'];
          
          for (let i = 0; i < 50; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.top = '-10px';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
            document.body.appendChild(confetti);
            
            const fall_duration = 2 + Math.random() * 2;
            const sway = (Math.random() - 0.5) * 200;
            
            confetti.animate([
              { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
              { transform: `translateY(100vh) translateX(${sway}px) rotate(720deg)`, opacity: 0 }
            ], {
              duration: fall_duration * 1000,
              easing: 'ease-out'
            }).onfinish = () => confetti.remove();
          }
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        new RewardManager();
      });
    </script>
  </body>
</html>
</CodeContent>
</invoke>
